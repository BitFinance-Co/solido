<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/solido/blog/rss.xml" title="Lido for Solana Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/solido/blog/atom.xml" title="Lido for Solana Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Governance Downstream | Lido for Solana</title><meta data-react-helmet="true" property="og:url" content="https://chorusone.github.io/solido/docs/WIP/Governance/governance-downstream"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Governance Downstream | Lido for Solana"><meta data-react-helmet="true" name="description" content="Governance in the Downstream Programs"><meta data-react-helmet="true" property="og:description" content="Governance in the Downstream Programs"><link data-react-helmet="true" rel="shortcut icon" href="/solido/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chorusone.github.io/solido/docs/WIP/Governance/governance-downstream"><link data-react-helmet="true" rel="alternate" href="https://chorusone.github.io/solido/docs/WIP/Governance/governance-downstream" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://chorusone.github.io/solido/docs/WIP/Governance/governance-downstream" hreflang="x-default"><link rel="stylesheet" href="/solido/assets/css/styles.f14eb037.css">
<link rel="preload" href="/solido/assets/js/runtime~main.237cc3ac.js" as="script">
<link rel="preload" href="/solido/assets/js/main.489273f0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solido/"><img src="/solido/img/lido-droplet-round.svg" alt="Lido for Solana Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/solido/img/lido-droplet-round.svg" alt="Lido for Solana Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Lido for Solana</strong></a><a class="navbar__item navbar__link" href="/solido/docs/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://medium.com/chorus-one/introducing-lido-for-solana-8aa02db8503" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://github.com/chorusone/solido" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/solido/"><img src="/solido/img/lido-droplet-round.svg" alt="Lido for Solana Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/solido/img/lido-droplet-round.svg" alt="Lido for Solana Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Lido for Solana</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/solido/docs/">Documentation</a></li><li class="menu__list-item"><a href="https://medium.com/chorus-one/introducing-lido-for-solana-8aa02db8503" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://github.com/chorusone/solido" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Governance Downstream</h1></header><div class="markdown"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="governance-in-the-downstream-programs"></a>Governance in the Downstream Programs<a class="hash-link" href="#governance-in-the-downstream-programs" title="Direct link to heading">#</a></h3><p>This note documents governance related changes/additions we seek in the two &#x27;child&#x27; programs</p><ol><li>Stake Pool Program</li><li>Lido Program</li></ol><p>It assumes that we have already setup the &#x27;parent&#x27; program - i.e. the Governance program (multi-sig or otherwise) and the relevant signatory address for the Governance is at <code>0xGovernance</code></p><p>In the context of the <code>Serum Multisig</code> program that we are using, <code>0xGovernance</code> refers to PDA discussed in <a href="https://github.com/ChorusOne/solido/issues/26#issuecomment-829439107" target="_blank" rel="noopener noreferrer">this comment</a></p><p><code>From the multisig account and the Multisig program id, we get a program derived address. This is the address that the multisig can sign with, so this is the one that you can set as e.g. the upgrade authority for the Lido program.</code></p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-stake-pool-program"></a>1. Stake Pool Program<a class="hash-link" href="#1-stake-pool-program" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="upgrade-authority"></a>Upgrade Authority<a class="hash-link" href="#upgrade-authority" title="Direct link to heading">#</a></h3><ul><li>Assuming we are going to deploy our own Stake Pool Program<ul><li>(and maintain it)</li><li>We need to set upgrade authority of this deployment to <code>0xGovernance</code></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="manager-role"></a>Manager Role<a class="hash-link" href="#manager-role" title="Direct link to heading">#</a></h3><ul><li>Set to <code>0xGovernance</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="staker-role"></a>Staker Role<a class="hash-link" href="#staker-role" title="Direct link to heading">#</a></h3><ul><li>Set to Lido Program<ul><li>This might involve a chicken-egg situation at init.</li><li>One potential resolution<ul><li><ol><li>On initialisation of Stake Pool : set <code>Staker Role</code> of <code>Stake Pool Program</code> to be <code>0xGovernance</code></li></ol></li><li><ol start="2"><li>Then deploy and initialise the Lido Program (say, at <code>0xLido</code>)</li></ol></li><li><ol start="3"><li>Then modify <code>Staker Role</code> of <code>Stake Pool Program</code> = <code>0xLido</code><ul><li>use the <code>SetStaker</code> instruction of StakePool Program</li></ul></li></ol></li></ul></li></ul></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-lido-program"></a>2. Lido Program<a class="hash-link" href="#2-lido-program" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="upgrade-authority-1"></a>Upgrade Authority<a class="hash-link" href="#upgrade-authority-1" title="Direct link to heading">#</a></h3><ul><li>While deploying the Lido program, set upgrade authority to<code>0xGovernance</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="owner-role"></a>Owner Role<a class="hash-link" href="#owner-role" title="Direct link to heading">#</a></h3><ul><li>Lido Program has an owner role to be provided at init</li><li>Set this owner to be<code>0xGovernance</code></li><li>I am going to reference this as <code>Lido Owner</code> in all the notes below.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="whitelist-for-maintenance-responsibilities"></a>Whitelist for Maintenance Responsibilities<a class="hash-link" href="#whitelist-for-maintenance-responsibilities" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="context"></a>Context<a class="hash-link" href="#context" title="Direct link to heading">#</a></h4><ul><li>There are certain maintenance actions/instructions in the Lido Program<ul><li>eg. delegating SOL in Lido Program across validators in Stake Pool Program</li><li>eg. rebalancing stakes</li></ul></li><li>Requiring <code>Lido Owner</code> (aka the multisig governance) to sign off each time would be overkill for these responsibilities</li><li>Opening these to anyone-can-call might be abused by jokers</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="solution"></a>Solution<a class="hash-link" href="#solution" title="Direct link to heading">#</a></h4><ul><li><p>Midway Solution - A Whitelist of Maintainers</p><ul><li>Lido Program to maintain a list of addresses corresponding to maintainers</li><li>All Maintenance responsibilities are gated to &#x27;onlyMaintainers&#x27;</li><li><code>Lido Owner</code> is part of the list</li><li>Additionally, <code>Lido Owner</code> can add/remove addresses from this list</li></ul></li><li><p>Potential Implementation</p><ul><li><p>Store this list in the Lido State - <code>Maintainers_List</code></p></li><li><p>We will need instructions for <code>Add Maintainer</code> / <code>Remove Maintainer</code></p><ul><li>These two instructions are gated to &#x27;onlyLidoOwner&#x27;</li></ul></li><li><p>Create a method in state.rs : <code>check_maintainer</code></p><ul><li>This is similar to <code>check_manager</code> in the Stake Pool library (<code>state.rs</code>)</li><li>Returns true only if the signer is in the list (and has proper signature)<ul><li>Question for Fynn : How costly will this lookup be? (Say a list of 20 maintainers?)</li></ul></li></ul></li><li><p>Add <code>check_maintainer</code> in the implementation of instructions you want to gate to <code>onlyMaintainers</code></p></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="gating-delegatedeposits"></a>Gating DelegateDeposits<a class="hash-link" href="#gating-delegatedeposits" title="Direct link to heading">#</a></h3><ul><li>As discussed above : gate DelegateDeposit to <code>onlyMaintainers</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="staker-role-responsibilities"></a>Staker Role Responsibilities<a class="hash-link" href="#staker-role-responsibilities" title="Direct link to heading">#</a></h3><ul><li><p><code>Staker Role</code> of Stake Pool Program will be the Lido Program</p></li><li><p><code>Staker Role</code> corresponds to following responsibilities (instructions) in the Stake Pool Program</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">-  1. Set_Staker (needs signature of both manager and staker)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-  2. CreateValidatorStakeAccount</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-  3. AddValidatorFromPool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-  4. RemoveValidatorFromPool</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-  5. DecreaseValidatorStake</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-  6. IncreaseValidatorStake</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>We need to proxy these instructions via the Lido Program</p><ul><li>Proxy Instructions 1. to 4. and gate them to <code>onlyLidoOwner</code></li><li>Proxy Instructions 5., 6. and gate them to <code>onlyMaintainers</code></li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="fee-params"></a>Fee Params<a class="hash-link" href="#fee-params" title="Direct link to heading">#</a></h3><ul><li>These params are listed in <a href="/solido/docs/WIP/Governance/fee-management.md">Fee Management Document</a></li><li>We need to maintain these params in the Lido Program</li><li>We will need to add functions to modify these params - and gate them to onlyLidoOwner</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pausedeposits"></a>PauseDeposits<a class="hash-link" href="#pausedeposits" title="Direct link to heading">#</a></h3><ul><li><p>Discuss if we need a way to pause deposits</p><ul><li>We might need this early on, when the Lido Program is initialised but we are still setting up params, validators etc</li><li>There might be a reason to pause deposits - at some later point too. eg. bug discovered, need to upgrade Lido</li></ul></li><li><p>Potential Implementation</p><ul><li>A boolean flag <code>PAUSE_DEPOSITS</code> initially set to <code>TRUE</code></li><li>Only editable by <code>Lido Owner</code> (aka 0xGovernance)</li><li>Once everything is setup, <code>Lido Owner</code> can set this to <code>FALSE </code></li><li>The implementation function for Deposit - does an upfront check for <code>PAUSE_DEPOSITS</code> - and fails if it is <code>TRUE</code>.</li></ul></li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#governance-in-the-downstream-programs" class="table-of-contents__link">Governance in the Downstream Programs</a></li><li><a href="#1-stake-pool-program" class="table-of-contents__link">1. Stake Pool Program</a><ul><li><a href="#upgrade-authority" class="table-of-contents__link">Upgrade Authority</a></li><li><a href="#manager-role" class="table-of-contents__link">Manager Role</a></li><li><a href="#staker-role" class="table-of-contents__link">Staker Role</a></li></ul></li><li><a href="#2-lido-program" class="table-of-contents__link">2. Lido Program</a><ul><li><a href="#upgrade-authority-1" class="table-of-contents__link">Upgrade Authority</a></li><li><a href="#owner-role" class="table-of-contents__link">Owner Role</a></li><li><a href="#whitelist-for-maintenance-responsibilities" class="table-of-contents__link">Whitelist for Maintenance Responsibilities</a></li><li><a href="#gating-delegatedeposits" class="table-of-contents__link">Gating DelegateDeposits</a></li><li><a href="#staker-role-responsibilities" class="table-of-contents__link">Staker Role Responsibilities</a></li><li><a href="#fee-params" class="table-of-contents__link">Fee Params</a></li><li><a href="#pausedeposits" class="table-of-contents__link">PauseDeposits</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/solido/docs/overview">Documentation</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/chorusone" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://medium.com/chorus-one" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://medium.com/chorus-one/introducing-lido-for-solana-8aa02db8503" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/chorusone/solido" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 ChorusOne.</div></div></div></footer></div>
<script src="/solido/assets/js/runtime~main.237cc3ac.js"></script>
<script src="/solido/assets/js/main.489273f0.js"></script>
</body>
</html>